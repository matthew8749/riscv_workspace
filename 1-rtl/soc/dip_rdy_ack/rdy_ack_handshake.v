// +FHDR--------------------------------------------------------------------------------------------------------- //
// Project ____________                                                                                           //
// File name __________ rdy_ack_handshake.v                                                                              //
// Creator ____________ Yan, Wei-Ting                                                                             //
// Built Date _________ MMM-DD-YYYY                                                                               //
// Function ___________                                                                                           //
// Hierarchy __________                                                                                           //
//   Parent ___________                                                                                           //
//   Children _________                                                                                           //
// Revision history ___ Date        Author            Description                                                 //
//                  ___                                                                                           //
// -FHDR--------------------------------------------------------------------------------------------------------- //
//+...........+...................+.............................................................................. //
//3...........15..................35............................................................................. //
`timescale 1ns/10ps

module rdy_ack_handshake (
  input  wire                     rst_n,
  input  wire                     clk,

  input  wire                     wr_rdy,           // 我已準備好接資料
  output wire                     wr_ack,           // 回復"確認收到資料" (one-cycle pulse)

  output reg                      rd_rdy,           // 下游準備好收資料
  input  wire                     rd_ack            // 接收"確認收到資料" (one-cycle pulse)
);

// tag COMPONENTs and SIGNALs declaration --------------------------------------------------------------------------

// tag OUTs assignment ---------------------------------------------------------------------------------------------
assign  wr_ack = wr_rdy && ((rd_rdy == 1'b0) || (rd_rdy && rd_ack) );

// tag INs assignment ----------------------------------------------------------------------------------------------

// tag COMBINATIONAL LOGIC -----------------------------------------------------------------------------------------

// tag COMBINATIONAL PROCESS ---------------------------------------------------------------------------------------

// tag SEQUENTIAL LOGIC --------------------------------------------------------------------------------------------
// ***********************/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**\**\****/**/**
//                       /**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/****\**\**/**/***
// *********************/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/******\**\/**/****

always @ (posedge clk or negedge rst_n) begin
  if (!rst_n) begin
    rd_rdy <= 1'b0;
  end else begin
    if (wr_rdy && (rd_rdy == 1'b0) ) begin
      rd_rdy <= 1'b1;
    end else if ( (wr_rdy == 1'b0) && rd_rdy && rd_ack ) begin
      rd_rdy <= 1'b0;
    end

  end
end




endmodule